<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <title>LLM Adapter レポート</title>
  <script src="https://cdn.jsdelivr.net/npm/plotly.js-dist-min"></script>
  <style>
    body { font-family: sans-serif; margin: 2rem; }
    table { border-collapse: collapse; width: 100%; margin-top: 1rem; }
    th, td { border: 1px solid #ccc; padding: 0.5rem; text-align: left; }
    th { background-color: #f5f5f5; }
    section { margin-bottom: 2rem; }
  </style>
</head>
<body>
  <h1>LLM Adapter メトリクスレポート</h1>
  <section>
    <h2>Overview</h2>
    
    <ul>
      <li>総試行数: 4</li>
      <li>成功率: 100.0%</li>
      <li>平均レイテンシ: 312.5 ms</li>
      <li>中央値レイテンシ: 312.5 ms</li>
      <li>総コスト: $0.0</li>
      <li>平均コスト: $0.0</li>
    </ul>
    
  </section>
  <section>
    <h2>比較テーブル</h2>
    <table>
      <thead>
        <tr>
          <th>Provider</th>
          <th>Model</th>
          <th>Prompt</th>
          <th>Attempts</th>
          <th>OK%</th>
          <th>Avg Latency</th>
          <th>Avg Cost</th>
          <th>Avg Diff Rate</th>
        </tr>
      </thead>
      <tbody>
        <tr><td>simulated</td><td>simulator-v1</td><td>task-001</td><td>2</td><td>100.0%</td><td>310 ms</td><td>$0.0</td><td>0.0</td></tr><tr><td>simulated</td><td>simulator-v1</td><td>task-002</td><td>2</td><td>100.0%</td><td>315 ms</td><td>$0.0</td><td>0.0</td></tr>
      </tbody>
    </table>
  </section>
  <section>
    <h2>Latency Histogram</h2>
    <div id="latency_hist" style="width:100%;height:400px;"></div>
  </section>
  <section>
    <h2>Cost vs Latency</h2>
    <div id="cost_latency_scatter" style="width:100%;height:400px;"></div>
  </section>
  <section>
    <h2>Failure Summary</h2>
    <p>失敗は記録されていません。</p>
  </section>
  <section>
    <h2>Determinism Alerts</h2>
    <p>決定性アラートはありません。</p>
  </section>
  <section>
    <h2>Baseline Regression</h2>
    <p>PASS: 2 / FAIL: 0 / OTHER: 0</p>
    <table>
      <thead>
        <tr>
          <th>Provider</th>
          <th>Model</th>
          <th>Prompt</th>
          <th>Threshold</th>
          <th>Baseline Diff</th>
          <th>Latest Diff</th>
          <th>Latest Status</th>
          <th>Result</th>
          <th>Notes</th>
        </tr>
      </thead>
      <tbody>
        <tr><td>simulated</td><td>simulator-v1</td><td>task-001</td><td>0.050</td><td>-</td><td>0.000</td><td>ok</td><td>PASS</td><td>ログインフローは SUCCESS を返す想定</td></tr>
<tr><td>simulated</td><td>simulator-v1</td><td>task-002</td><td>0.050</td><td>-</td><td>0.000</td><td>ok</td><td>PASS</td><td>パスワードリセットは RESET_OK を返す想定</td></tr>
      </tbody>
    </table>
    
  </section>
  <script>
    const histData = {"simulated": [310.0, 310.0, 315.0, 315.0]};
    const histTraces = Object.keys(histData).map(provider => ({
      type: 'histogram',
      name: provider,
      x: histData[provider],
      opacity: 0.6,
    }));
    Plotly.newPlot('latency_hist', histTraces, {barmode: 'overlay', title: 'Latency Histogram'});

    const scatterRaw = {"simulated": [{"latency": 310.0, "cost": 0.0, "prompt_id": "task-001"}, {"latency": 310.0, "cost": 0.0, "prompt_id": "task-001"}, {"latency": 315.0, "cost": 0.0, "prompt_id": "task-002"}, {"latency": 315.0, "cost": 0.0, "prompt_id": "task-002"}]};
    const scatterTraces = Object.keys(scatterRaw).map(provider => ({
      x: scatterRaw[provider].map(p => p.latency),
      y: scatterRaw[provider].map(p => p.cost),
      mode: 'markers',
      type: 'scatter',
      name: provider,
      text: scatterRaw[provider].map(p => p.prompt_id),
    }));
    Plotly.newPlot('cost_latency_scatter', scatterTraces, {
      title: 'Cost vs Latency',
      xaxis: {title: 'Latency (ms)'},
      yaxis: {title: 'Cost (USD)'},
    });
  </script>
</body>
</html>
